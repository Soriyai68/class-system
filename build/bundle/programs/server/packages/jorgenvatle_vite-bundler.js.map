{"version":3,"sources":["meteor://💻app/packages/jorgenvatle:vite-bundler/src/server.ts","meteor://💻app/packages/jorgenvatle:vite-bundler/src/workers.ts","meteor://💻app/packages/jorgenvatle:vite-bundler/src/api/Collections.ts","meteor://💻app/packages/jorgenvatle:vite-bundler/src/api/DDP-IPC.ts","meteor://💻app/packages/jorgenvatle:vite-bundler/src/api/Endpoints.ts","meteor://💻app/packages/jorgenvatle:vite-bundler/src/api/Watchers.ts","meteor://💻app/packages/jorgenvatle:vite-bundler/src/loading/vite-connection-handler.ts","meteor://💻app/packages/jorgenvatle:vite-bundler/src/utility/AnsiColor.ts","meteor://💻app/packages/jorgenvatle:vite-bundler/src/utility/DDPLogger.ts","meteor://💻app/packages/jorgenvatle:vite-bundler/src/utility/Errors.ts","meteor://💻app/packages/jorgenvatle:vite-bundler/src/utility/Helpers.ts","meteor://💻app/packages/jorgenvatle:vite-bundler/src/utility/Logger.ts","meteor://💻app/packages/jorgenvatle:vite-bundler/src/vite-boilerplate/common.ts","meteor://💻app/packages/jorgenvatle:vite-bundler/src/vite-boilerplate/development.ts","meteor://💻app/packages/jorgenvatle:vite-bundler/src/vite-boilerplate/production.ts"],"names":["WebApp","WebAppInternals","module","link","v","Logger","default","ViteDevServerWorker","ViteProductionBoilerplate","__reifyWaitForDeps__","worker","Meteor","isProduction","startup","start","registerBoilerplateDataCallback","request","data","dynamicBody","dynamicHead","getBoilerplate","concat","debug","baseUrl","makeViteAssetsCacheable","connectHandlers","use","assetDir","req","res","next","writeHead","write","warn","originalUrl","end","__reify_async_result__","_reifyError","self","async","export","createWorkerFork","isMeteorIPCMessage","cwd","workerPath","getProjectPackageJson","fork","Random","Path","FS","pc","getMeteorRuntimeConfig","hooks","options","_options$detached","_options$ipc","_options$ipc2","existsSync","MeteorViteError","yellow","child","stdio","detached","env","prepareWorkerEnv","ipcOverDdp","ipc","active","unref","hookMethods","Object","keys","forEach","method","hook","bindEnvironment","workerConfigHook","workerConfig","pid","listening","process","ENABLE_DEBUG_LOGS","console","log","join","setResponseHooks","on","message","kind","code","error","connected","call","_ref","_options$ipc3","_options$ipc4","params","id","send","type","topic","Error","constructor","Array","isArray","name","_process$env$METEOR_V","METEOR_VITE_CWD","guessCwd","file","arguments","length","undefined","path","JSON","parse","readFileSync","_process$env$PWD","PWD","index","indexOf","substring","_ref2","workerEnvPrefix","FORCE_COLOR","METEOR_LOCAL_DIR","STARTED_AT","Date","now","toString","NODE_ENV","METEOR_RUNTIME","fallback","assign","DDP_IPC","stringify","entries","_ref3","key","value","startsWith","unPrefixedKey","replace","RegExp","_objectSpread","StatusCollection","DataStreamCollection","IpcCollection","Mongo","Collection","connection","transform","doc","responseHooks","methods","meteor-vite:ipc.received","removeAsync","publish","find","insertAsync","catch","Methods","watchDataStreamLogs","meteor-vite:status/update","status","appId","upsertAsync","$set","updatedAt","$setOnInsert","createdAt","meteor-vite:log","isClient","$in","limit","sort","DDPLogger","watcherActive","startupTime","subscribe","onReady","onStop","$gt","observe","added","document","print","module1","MeteorViteConfig","VITE_ENTRYPOINT_SCRIPT_ID","VITE_CLIENT_SCRIPT_ID","ViteDevScripts","ViteConnection","getConfig","setConfig","DevConnectionLog","config","urls","needsReactPreamble","entrypointUrl","entryFile","viteClientUrl","reactRefresh","packageJson","dependencies","devDependencies","stringTemplate","ready","Assets","getTextAsync","getText","moduleLines","unshift","injectScriptsInDOM","isServer","isDevelopment","existingScript","getElementById","TemporaryElements","splashScreen","styles","viteEntrypoint","createElement","src","setAttribute","viteClient","onerror","setTimeout","window","location","reload","onload","_TemporaryElements$sp","_TemporaryElements$st","info","remove","body","prepend","runtimeConfig","host","port","lastUpdate","publication","refreshConfig","configSelector","_id","_config$resolvedUrls","_config$resolvedUrls$","_config$resolvedUrls2","_config$resolvedUrls3","viteConfig","findOneAsync","resolvedUrls","network","local","METEOR_VITE_HOST","METEOR_VITE_PROTOCOL","METEOR_VITE_PORT","age","runSetters","logLabel","_logToScreen","_document$querySelect","messageNode","innerText","querySelector","_len","_key","_len2","_key2","_len3","_key3","param","stack","AnsiColor","defineColor","prefix","suffix","dim","green","blue","red","inspect","serializeArgs","args","callAsync","styleMessage","sender","level","map","depth","colors","_this","levels","String","success","_len4","_key4","_len5","_key5","_len6","_key6","_len7","_key7","_len8","_key8","_len9","_key9","_len10","_key10","exportDefault","details","msToHumanTime","posixPath","getTempDir","getDevServerHost","getBuildConfig","OS","milliseconds","duration","count","Math","round","filePath","split","sep","_packageJson$meteor","_packageJson$meteor$v","tempRootDir","meteor","vite","tempBuildDir","tmpdir","tempDir","resolve","mkdirSync","recursive","cause","_process$argv$join$ma","portString","hostname","argv","match","groups","METEOR_PORT","DDP_DEFAULT_CONNECTION_URL","MOBILE_DDP_URL","_DDP_DEFAULT_CONNECTI","_MOBILE_DDP_URL$match","parseInt","Number","isNaN","_meteor_bootstrap__","_meteor_bootstrap__$c","__meteor_bootstrap__","configJson","_packageJson$meteor2","_packageJson$meteor2$","pluginEnabled","VITE_METEOR_DISABLED","METEOR_VITE_DISABLED","meteorMainModule","mainModule","client","viteOutSrcDir","isSimulatedProduction","includes","tempMeteorProject","tempMeteorOutDir","fs","performance","BuildLogger","debugEnabled","github","GithubActions","debugEnv","DEBUG","trim","field","DEBUG_ENV_TRIGGERS","annotate","startProfiler","startTime","complete","messageWithTiming","summarize","summaryLines","stepSummaryFile","useAnnotations","METEOR_VITE_DISABLE_CI_SUMMARY","GITHUB_STEP_SUMMARY","formattedArgs","push","summary","writeFileSync","ViteBoilerplate","fetch","viteServer","refreshNeeded","meteorParentPid","ppid","meteorConfig","scripts","Util","viteManifest","assetsDir","base","imports","lines","prefetchArray","stylesheets","modules","modulePreload","moduleLazyPrefetch","href","cssLazyPrefetch","as","lazyPrefetch","assets","addEventListener","makeLink","asset","rel","fetchPriority","loadNext","fragment","DocumentFragment","shift","append","head","DISABLE_FULL_APP_PREFETCH","_Meteor$settings$vite","settings","manifest","viteManifestInfo","clientPrograms","endsWith","viteManifestPath","serverDir","archs","arch","files","staticFilesByArch","cacheable","_Meteor$settings$vite2","Set","preloadImports","_chunk$css","chunk","has","delete","add","css","_chunk$css2","isEntry"],"mappings":"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","file":"/packages/jorgenvatle_vite-bundler.js","sourcesContent":["import HTTP from 'http';\nimport { WebApp, WebAppInternals } from 'meteor/webapp';\nimport Logger from './utility/Logger';\nimport type { BoilerplateData } from './vite-boilerplate/common';\nimport { ViteDevServerWorker } from './vite-boilerplate/development';\nimport { ViteProductionBoilerplate } from './vite-boilerplate/production';\n\nconst worker = Meteor.isProduction ? new ViteProductionBoilerplate()\n                                   : new ViteDevServerWorker();\n\nif ('start' in worker) {\n    Meteor.startup(() => {\n        worker.start();\n    })\n}\n\nWebAppInternals.registerBoilerplateDataCallback('meteor-vite', async (request: HTTP.IncomingMessage, data: BoilerplateData) => {\n    const { dynamicBody, dynamicHead } = await worker.getBoilerplate();\n    \n    if (dynamicHead) {\n        data.dynamicHead = `${data.dynamicHead || ''}\\n${dynamicHead}`;\n    }\n    \n    if (dynamicBody) {\n        data.dynamicBody = `${data.dynamicBody || ''}\\n${dynamicBody}`;\n    }\n});\n\nif (worker instanceof ViteProductionBoilerplate) {\n    Meteor.startup(() => {\n        Logger.debug(`Vite asset base URL: ${worker.baseUrl}`);\n        worker.makeViteAssetsCacheable();\n    })\n    \n    // Prevent Meteor from sending a 200 OK HTML file when the request is clearly not valid.\n    // If an asset is found by Meteor, this hook will not be called.\n    WebApp.connectHandlers.use(worker.assetDir, (req, res, next) => {\n        res.writeHead(404, 'Not found');\n        res.write('Vite asset could not be found.')\n        Logger.warn(`Served 404 for Vite asset request: ${req.originalUrl}`);\n        res.end();\n    })\n}\n\n","import type { ChildProcess } from 'concurrently/dist/src/command';\nimport { fork } from 'node:child_process';\nimport { Meteor } from 'meteor/meteor';\nimport { Random } from 'meteor/random';\nimport Path from 'path';\nimport FS from 'fs';\nimport pc from 'picocolors';\nimport type { WorkerMethod, WorkerResponse, WorkerResponseHooks, MeteorIPCMessage, ProjectJson } from 'meteor-vite';\nimport type { DDP_IPC } from './api/DDP-IPC';\nimport { getMeteorRuntimeConfig } from './utility/Helpers';\n\n// Use a worker to skip reify and Fibers\n// Use a child process instead of worker to avoid WASM/archived threads error\nexport function createWorkerFork(hooks: Partial<WorkerResponseHooks>, options?: {\n    detached: boolean,\n    ipc?: DDP_IPC;\n}) {\n    if (!FS.existsSync(workerPath)) {\n        throw new MeteorViteError([\n            `Unable to locate Meteor-Vite workers! Make sure you've installed the 'meteor-vite' npm package.`,\n            `Install it by running the following command:`,\n            `$  ${pc.yellow('npm i -D meteor-vite')}`\n        ])\n    }\n    \n    const child = fork(workerPath, ['--enable-source-maps'], {\n        stdio: ['inherit', 'inherit', 'inherit', 'ipc'],\n        cwd,\n        detached: options?.detached ?? false,\n        env: prepareWorkerEnv({ ipcOverDdp: !!options?.ipc?.active }),\n    });\n    \n    if (options?.detached) {\n        child.unref();\n    }\n    \n    const hookMethods = Object.keys(hooks) as (keyof typeof hooks)[];\n    hookMethods.forEach((method) => {\n        const hook = hooks[method];\n        if (typeof hook !== 'function') return;\n        (hooks[method] as typeof hook) = Meteor.bindEnvironment(hook);\n    })\n    \n    const workerConfigHook = hooks.workerConfig;\n    hooks.workerConfig = (data) => {\n        if (typeof workerConfigHook === 'function') {\n            workerConfigHook(data);\n        }\n        const { pid, listening } = data;\n        if (listening && process.env.ENABLE_DEBUG_LOGS) {\n            console.log('Running Vite worker as a background process..\\n  ', [\n                `Background PID: ${pid}`,\n                `Child process PID: ${child.pid}`,\n                `Meteor PID: ${process.pid}`,\n                `Is vite server: ${listening}`,\n            ].join('\\n   '));\n        }\n    }\n    \n    if (options?.ipc?.active) {\n        options.ipc.setResponseHooks(hooks);\n    }\n    \n    child.on('message', (message: WorkerResponse & { data: any }) => {\n        const hook = hooks[message.kind];\n        \n        if (typeof hook !== 'function') {\n            return console.warn('Meteor: Unrecognized worker message!', { message });\n        }\n        \n        return hook(message.data);\n    });\n    \n    child.on('exit', (code) => {\n        if (code || process.env.ENABLE_DEBUG_LOGS) {\n            console.warn('Child exited with code:', code);\n        }\n    })\n    \n    child.on('error', (error) => {\n        console.error('Meteor: Worker process error:', error);\n        if (!child.connected) {\n            throw new MeteorViteError('Lost connection to Vite worker process');\n        }\n    });\n    \n    child.on('disconnect', () => {\n        if (process.env.ENABLE_DEBUG_LOGS) {\n            console.warn('Meteor: Worker process disconnected');\n        }\n    })\n    \n    return {\n        call({ params, method }: Omit<WorkerMethod, 'id'>) {\n            const message = {\n                id: Random.id(),\n                method,\n                params,\n            } as WorkerMethod;\n            \n            if (!options?.ipc?.active && !child.connected) {\n                throw new MeteorViteError(`Oops worker process is not connected! Tried to send message to worker: ${method}`);\n            }\n            \n            if (options?.ipc?.active) {\n                options.ipc.call(message);\n            }\n            \n            if (child.connected) {\n                child.send(message);\n            }\n        },\n        child,\n    }\n}\n\nexport type WorkerInstance = {\n    call(method: Omit<WorkerMethod, 'replies'>): void;\n    child: ChildProcess;\n}\n\nexport function isMeteorIPCMessage<\n    Topic extends MeteorIPCMessage['topic']\n>(message: unknown): message is MeteorIPCMessage  {\n    if (!message || typeof message !== 'object') {\n        return false;\n    }\n    if (!('type' in message) || !('topic' in message)) {\n        return false;\n    }\n    if (message?.type !== 'METEOR_IPC_MESSAGE') {\n        return false;\n    }\n    if (typeof message.topic !== 'string') {\n        return false;\n    }\n    return true;\n}\n\nclass MeteorViteError extends Error {\n    constructor(message: string[] | string) {\n        if (!Array.isArray(message)) {\n            message = [message];\n        }\n        super(`\\n⚡  ${message.join('\\n L ')}`);\n        this.name = this.constructor.name;\n    }\n}\n\nexport const cwd = process.env.METEOR_VITE_CWD ?? guessCwd();\nexport const workerPath = Path.join(cwd, 'node_modules/meteor-vite/dist/bin/worker.mjs');\nexport function getProjectPackageJson<\n    TFile extends 'package.json' | 'package-lock.json' = 'package.json'\n>(file: TFile = 'package.json' as TFile): {\n    'package.json': ProjectJson;\n    'package-lock.json': {\n        name: string;\n        // lockfile v3\n        packages?: Partial<Record<string, { version: string }>>\n        \n        // lockfile v1\n        dependencies?: Partial<Record<string, { version: string }>>;\n    }\n}[TFile] {\n    const path = Path.join(cwd, file);\n    \n    if (!FS.existsSync(path)) {\n        throw new MeteorViteError([\n            `Unable to locate ${pc.yellow(file)} for your project in ${pc.yellow(path)}`,\n            `Make sure you run Meteor commands from the root of your project directory.`,\n            `Alternatively, you can supply a superficial CWD for Meteor-Vite to use:`,\n            `$  cross-env METEOR_VITE_CWD=\"./projects/my-meteor-project/\" meteor run`\n        ])\n    }\n    \n    return JSON.parse(FS.readFileSync(path, 'utf-8'));\n}\n\nfunction guessCwd () {\n    let cwd = process.env.PWD ?? process.cwd()\n    const index = cwd.indexOf('.meteor')\n    if (index !== -1) {\n        cwd = cwd.substring(0, index)\n    }\n    return cwd\n}\n\nfunction prepareWorkerEnv({ ipcOverDdp = false }) {\n    const workerEnvPrefix = 'METEOR_VITE_WORKER_';\n    const env: Record<string, string | undefined> = {\n        FORCE_COLOR: '3',\n        ENABLE_DEBUG_LOGS: process.env.ENABLE_DEBUG_LOGS,\n        METEOR_LOCAL_DIR: process.env.METEOR_LOCAL_DIR,\n        STARTED_AT: Date.now().toString(),\n        NODE_ENV: process.env.NODE_ENV,\n    }\n    if (ipcOverDdp) {\n        const METEOR_RUNTIME = getMeteorRuntimeConfig()\n        if (!METEOR_RUNTIME.fallback) {\n            Object.assign(env, {\n                DDP_IPC: true,\n                METEOR_RUNTIME: JSON.stringify(METEOR_RUNTIME),\n            })\n        }\n    }\n    Object.entries(process.env).forEach(([key, value]) => {\n        if (!key.startsWith(workerEnvPrefix)) {\n            return;\n        }\n        const unPrefixedKey = key.replace(new RegExp(`^${workerEnvPrefix}`), '');\n        env[key] = value;\n        env[unPrefixedKey] = value;\n    })\n    return env;\n}\n","import type { WorkerMethod } from 'meteor-vite';\nimport { Mongo } from 'meteor/mongo';\nimport type { RuntimeConfig } from '../loading/vite-connection-handler';\n\nexport const StatusCollection = new Mongo.Collection<StatusDocument>('_meteor-vite.status', { connection: null });\nexport const DataStreamCollection = new Mongo.Collection<DataStreamDocument>('_meteor-vite.data-stream');\nexport const IpcCollection = new Mongo.Collection<SerializedIpcDocument, IpcDocument>('_meteor-vite.ipc', {\n    connection: null,\n    transform: (doc: SerializedIpcDocument) => {\n        return {\n            ...doc,\n            params: JSON.parse(doc.params),\n        }\n    }\n});\n\nexport interface BaseDocument {\n    createdAt: Date;\n    updatedAt?: Date;\n}\n\nexport interface StatusDocument<TStatus extends keyof MeteorViteStatus = keyof MeteorViteStatus> extends BaseDocument {\n    type: TStatus,\n    data: MeteorViteStatus[TStatus];\n    appId: string;\n}\n\ninterface MeteorViteStatus {\n    viteConfig: RuntimeConfig;\n    viteWorker: {\n        pid: number;\n        meteorPid: number;\n        meteorParentPid: number;\n        lastHeartbeat: Date;\n        startedAt: Date;\n    }\n}\n\nexport interface IpcDocument<TMethod extends WorkerMethod = WorkerMethod> {\n    method: TMethod['method']\n    params: TMethod['params'];\n}\n\nexport interface SerializedIpcDocument<TMethod extends WorkerMethod = WorkerMethod> {\n    method: TMethod['method'];\n    params: string;\n}\n\nexport type DataStreamLogType = 'log:client' | 'log:server' | 'log:shared';\nexport type DataStreamLogLevels = 'info' | 'debug' | 'error' | 'success' | 'warn';\n\nexport interface DataStreamDocument extends BaseDocument {\n    type: DataStreamLogType;\n    level: DataStreamLogLevels;\n    message: string;\n    sender?: string;\n}","import type { WorkerMethod, WorkerResponse, WorkerResponseHooks } from 'meteor-vite';\nimport { getMeteorRuntimeConfig } from '../utility/Helpers';\nimport { IpcCollection } from './Collections';\n\ntype IpcResponse = WorkerResponse & { data: any }\n\nexport class DDP_IPC {\n    constructor(public readonly responseHooks: Partial<WorkerResponseHooks>) {\n        Meteor.methods({\n            'meteor-vite:ipc': ({ kind, data }: IpcResponse) => {\n                const hook = this.responseHooks[kind];\n                \n                if (typeof hook !== 'function') {\n                    return console.warn('Meteor: Unrecognized worker message!', { message: { kind, data }});\n                }\n                \n                return hook(data);\n            },\n            async 'meteor-vite:ipc.received'(id: string) {\n                await IpcCollection.removeAsync(id)\n            }\n        });\n        Meteor.publish('meteor-vite:ipc', function() {\n            return IpcCollection.find();\n        })\n    }\n    \n    public call({ method, params, id }: WorkerMethod) {\n        IpcCollection.insertAsync({\n            id,\n            method,\n            params: JSON.stringify(params),\n        }).catch((error: unknown) => {\n            console.error('Vite: Failed to send IPC event!', error);\n        })\n    }\n    \n    public setResponseHooks(responseHooks: Partial<WorkerResponseHooks>) {\n        Object.assign(this.responseHooks, responseHooks);\n    }\n    \n    /**\n     * Whether we are confident that Meteor can be reached over DDP from the current runtime config\n     */\n    public get active() {\n        return !getMeteorRuntimeConfig().fallback\n    }\n}","import { Meteor } from 'meteor/meteor';\nimport { getMeteorRuntimeConfig } from '../utility/Helpers';\nimport {\n    type BaseDocument,\n    DataStreamCollection,\n    type DataStreamDocument,\n    StatusCollection,\n    type StatusDocument,\n} from './Collections';\nimport { watchDataStreamLogs } from './Watchers';\n\nexport type MeteorViteMethods = typeof Methods;\n\nexport const Methods = {\n    async 'meteor-vite:status/update'(status: Omit<StatusDocument, keyof BaseDocument>) {\n        const { appId } = getMeteorRuntimeConfig();\n        await StatusCollection.upsertAsync(\n            { type: status.type },\n            {\n                $set: {\n                    data: Object.assign(status.data, { updatedAt: new Date(), appId  }),\n                },\n                $setOnInsert: {\n                    createdAt: new Date(),\n                }\n            },\n        );\n    },\n    async 'meteor-vite:log'(log: Omit<DataStreamDocument, keyof BaseDocument>) {\n        await DataStreamCollection.insertAsync(Object.assign(log, {\n            createdAt: new Date(),\n        }));\n    },\n}\n\nMeteor.startup(() => {\n    if (Meteor.isProduction) {\n        return;\n    }\n    \n    Meteor.methods(Methods);\n    watchDataStreamLogs();\n    \n    if (Meteor.isClient) {\n        return;\n    }\n    \n    Meteor.publish('meteor-vite:log', () => {\n        return DataStreamCollection.find({\n            type: { $in: ['log:client', 'log:shared'] },\n        }, {\n            limit: 50,\n            sort: { createdAt: -1 },\n        });\n    });\n    \n    // Todo: clean up old logs regularly\n});","import { Meteor } from 'meteor/meteor';\nimport DDPLogger from '../utility/DDPLogger';\nimport { DataStreamCollection } from './Collections';\nlet watcherActive = false;\n\nexport function watchDataStreamLogs() {\n    const startupTime = new Date();\n    \n    if (watcherActive) {\n        return console.warn(new Error('⚡ Data stream logs are already being watched'));\n    }\n    \n    if (Meteor.isProduction) {\n        throw new Error('meteor-vite data logs are only available in development mode');\n    }\n    \n    watcherActive = true;\n    \n    if (Meteor.isClient) {\n        Meteor.subscribe('meteor-vite:log', {\n            onReady() {\n                console.debug('⚡ Listening for logs from meteor-vite');\n            },\n            onStop(error: unknown) {\n                if (!error) {\n                    return console.debug('⚡ Unsubscribed from meteor-vite logs');\n                }\n                console.debug('⚡ Error from meteor-vite logs publication', error);\n            }\n        });\n    }\n    \n    DataStreamCollection.find({ createdAt: { $gt: startupTime } }).observe({\n        added(document) {\n            DDPLogger.print(document);\n        },\n    })\n}","import { WorkerResponseData } from 'meteor-vite';\nimport { Meteor } from 'meteor/meteor';\nimport { Mongo } from 'meteor/mongo';\nimport '../api/Endpoints';\nimport { getProjectPackageJson } from '../workers';\n\nexport type RuntimeConfig = WorkerResponseData<'viteConfig'> & { ready: boolean, lastUpdate: number, baseUrl: string };\nexport let MeteorViteConfig: Mongo.Collection<RuntimeConfig>;\nexport const VITE_ENTRYPOINT_SCRIPT_ID = 'meteor-vite-entrypoint-script';\nexport const VITE_CLIENT_SCRIPT_ID = 'meteor-vite-client';\nexport class ViteDevScripts {\n    public readonly urls;\n    public readonly needsReactPreamble: boolean;\n    constructor(public readonly config: RuntimeConfig) {\n        const { baseUrl } = config;\n        \n        this.urls = {\n            baseUrl,\n            entrypointUrl: `${baseUrl}/${config.entryFile}`,\n            viteClientUrl: `${baseUrl}/@vite/client`,\n            reactRefresh: `${baseUrl}/@react-refresh`,\n        }\n        \n        /**\n         * Determine whether to inject React Refresh snippet into HTML served by Meteor.\n         * Without this snippet, React HMR will not work with Meteor-Vite.\n         *\n         * {@link https://github.com/JorgenVatle/meteor-vite/issues/29}\n         * {@link https://github.com/vitejs/vite-plugin-react/issues/11#discussion_r430879201}\n         */\n        {\n            const packageJson = getProjectPackageJson();\n            this.needsReactPreamble = false;\n            \n            if ('@vitejs/plugin-react' in packageJson.dependencies) {\n                this.needsReactPreamble = true;\n            }\n            if ('@vitejs/plugin-react' in packageJson.devDependencies) {\n                this.needsReactPreamble = true;\n            }\n        }\n    }\n\n    public async stringTemplate(): Promise<string> {\n        const { viteClientUrl, entrypointUrl } = this.urls;\n        \n        if (!this.config.ready) {\n            if ('getTextAsync' in Assets) {\n                return Assets.getTextAsync('src/loading/dev-server-splash.html');\n            }\n            \n            return Assets.getText('src/loading/dev-server-splash.html')!;\n        }\n        \n        const moduleLines = [\n            `<script src=\"${viteClientUrl}\" type=\"module\" id=\"${VITE_CLIENT_SCRIPT_ID}\"></script>`,\n            `<script src=\"${entrypointUrl}\" type=\"module\" id=\"${VITE_ENTRYPOINT_SCRIPT_ID}\"></script>`\n        ]\n        \n        if (this.needsReactPreamble) {\n            moduleLines.unshift(`\n                <script type=\"module\">\n                  import RefreshRuntime from \"${this.urls.reactRefresh}\";\n                  RefreshRuntime.injectIntoGlobalHook(window)\n                  window.$RefreshReg$ = () => {}\n                  window.$RefreshSig$ = () => (type) => type\n                  window.__vite_plugin_react_preamble_installed__ = true\n                </script>\n            `)\n        }\n        \n        return moduleLines.join('\\n');\n    }\n    \n    public injectScriptsInDOM() {\n        if (Meteor.isServer) {\n            throw new Error('This can only run on the client!');\n        }\n        if (!Meteor.isDevelopment) {\n            return;\n        }\n        \n        // If the scripts already exists on the page, throw an error to prevent adding more than one script.\n        const existingScript = document.getElementById(VITE_ENTRYPOINT_SCRIPT_ID) || document.getElementById(VITE_CLIENT_SCRIPT_ID);\n        if (existingScript) {\n            throw new Error('Vite script already exists in the current document');\n        }\n        \n        const TemporaryElements = {\n            splashScreen: document.getElementById('meteor-vite-splash-screen'),\n            styles: document.getElementById('meteor-vite-styles'),\n        }\n        \n        // Otherwise create a new set of nodes so they can be appended to the document.\n        const viteEntrypoint = document.createElement('script');\n        viteEntrypoint.id = VITE_ENTRYPOINT_SCRIPT_ID;\n        viteEntrypoint.src = this.urls.entrypointUrl;\n        viteEntrypoint.type = 'module';\n        viteEntrypoint.setAttribute('defer', 'true');\n        \n        const viteClient = document.createElement('script');\n        viteClient.id = VITE_CLIENT_SCRIPT_ID;\n        viteClient.src = this.urls.viteClientUrl;\n        viteClient.type = 'module';\n        \n        viteEntrypoint.onerror = (error) => {\n            DevConnectionLog.error('Vite entrypoint module failed to load! Will refresh page shortly...', error);\n            setTimeout(() => window.location.reload(), 15000);\n        }\n        viteEntrypoint.onload = () => {\n            DevConnectionLog.info('Loaded Vite module dynamically! Hopefully all went well and your app is usable. 🤞');\n            TemporaryElements.splashScreen?.remove()\n            TemporaryElements.styles?.remove();\n        }\n        \n        document.body.prepend(viteEntrypoint, viteClient);\n    }\n}\n\nconst runtimeConfig: RuntimeConfig = {\n    ready: false,\n    host: 'localhost',\n    baseUrl: 'http://localhost:0',\n    port: 0,\n    entryFile: '',\n    lastUpdate: Date.now(),\n}\n\nexport const ViteConnection = {\n    publication: '_meteor_vite' as const,\n    methods: {\n        refreshConfig: '_meteor_vite_refresh_config',\n    },\n    configSelector: { _id: 'viteConfig' },\n}\n\nexport async function getConfig() {\n    const viteConfig = await MeteorViteConfig.findOneAsync(ViteConnection.configSelector);\n    const config = viteConfig || runtimeConfig;\n    let baseUrl = config.resolvedUrls?.network?.[0] || config.resolvedUrls?.local?.[0] || `http://localhost:${config.port}`;\n    \n    if (process.env.METEOR_VITE_HOST) {\n        baseUrl = `${process.env.METEOR_VITE_PROTOCOL || 'http'}://${process.env.METEOR_VITE_HOST}:${process.env.METEOR_VITE_PORT || config.port}`\n    }\n    \n    // Strip any trailing '/' characters\n    baseUrl = baseUrl.replace(/\\/+$/g, '');\n    \n    return {\n        ...config,\n        baseUrl,\n        age: Date.now() - config.lastUpdate,\n    }\n}\n\nexport async function setConfig<TConfig extends Partial<RuntimeConfig>>(config: TConfig) {\n    Object.assign(runtimeConfig, config, ViteConnection.configSelector, { lastUpdate: Date.now() });\n    \n    if (runtimeConfig.port && runtimeConfig.host && runtimeConfig.entryFile) {\n        runtimeConfig.ready = true;\n    }\n    \n    await MeteorViteConfig.upsertAsync(ViteConnection.configSelector, runtimeConfig);\n    return runtimeConfig;\n}\n\nif (Meteor.isDevelopment) {\n    MeteorViteConfig = new Mongo.Collection(ViteConnection.publication, { connection: null });\n}\nconst logLabel = Meteor.isClient ? `[Meteor-Vite] ⚡ ` : '⚡  ';\n\nexport const DevConnectionLog = {\n    _logToScreen(message: string) {\n        if (!Meteor.isClient) return;\n        const messageNode = document.createElement('div');\n        messageNode.innerText = message;\n        document.querySelector('.vite-status-text')?.prepend(messageNode);\n    },\n    info: (message: string, ...params: Parameters<typeof console.log>) => {\n        DevConnectionLog._logToScreen(` ⚡ ${message}`);\n        console.info(\n            `${logLabel} ${message}`,\n            ...params,\n        )\n    },\n    debug: (message: string, ...params: Parameters<typeof console.log>) => {\n        DevConnectionLog._logToScreen(` ⚡ ${message}`);\n        console.debug(\n            `${logLabel} ${message}`,\n            ...params,\n        )\n    },\n    error: (message: string, ...params: Parameters<typeof console.log>) => {\n        for (const param of params) {\n            if (param instanceof Error && param.stack) {\n                DevConnectionLog._logToScreen(param.stack);\n            }\n        }\n        DevConnectionLog._logToScreen(` ⚡ ${message}`);\n        console.error(\n            `${logLabel} ${message}`,\n            ...params,\n        )\n    },\n};\n","function defineColor(prefix: string, suffix: string) {\n    return (message: string) => {\n        return `${prefix}${message}${suffix}`;\n    }\n}\n\nexport const AnsiColor = {\n    dim: defineColor('\\x1b[2m', '\\x1b[22m'),\n    green: defineColor('\\x1b[32m', '\\x1b[39m'),\n    blue: defineColor('\\x1b[34m', '\\x1b[39m'),\n    red: defineColor('\\x1b[31m', '\\x1b[39m'),\n};","import pc from 'picocolors';\nimport type { BaseDocument, DataStreamDocument, DataStreamLogType } from '../api/Collections';\nimport { Methods } from '../api/Endpoints';\nimport { inspect } from 'node:util';\nimport { AnsiColor } from './AnsiColor';\n\nclass DDPLogger {\n    protected readonly type: DataStreamLogType = 'log:shared';\n    \n    constructor() {\n        if (Meteor.isServer) {\n            this.type = 'log:client';\n        }\n    }\n    \n    protected send(log: Omit<DataStreamDocument, 'type' | keyof BaseDocument> & { args: unknown[] }) {\n        const document: Omit<DataStreamDocument, keyof BaseDocument> = Object.assign({}, log, {\n            type: this.type,\n            message: [log.message, ...this.serializeArgs(log.args)].join(' '),\n        });\n        \n        if (!Meteor.isServer) {\n            Meteor.callAsync('meteor-vite:log', document).catch((error) => {\n                console.error('Failed to log message', error);\n            });\n            return;\n        }\n        \n        Methods['meteor-vite:log'](document).catch((error) => {\n            console.error('Failed to log message', error);\n        });\n    }\n    \n    protected styleMessage(data: Pick<DataStreamDocument, 'message' | 'level' | 'sender'>) {\n        const prefix = data.sender ? AnsiColor.dim(`[${data.sender}]`) + ' ' : '';\n        const message = `⚡  ${prefix}${data.message}`;\n        switch (data.level) {\n            case 'info':\n                return pc.blue(message);\n            case 'error':\n                return pc.red(message);\n            case 'warn':\n                return pc.yellow(message);\n            case 'success':\n                return pc.green(message);\n            case 'debug':\n                return pc.dim(pc.blue(message));\n        }\n    }\n    \n    protected serializeArgs(args: LogMethodArgs) {\n        return args.map((data) => {\n            return inspect(data, { depth: 2, colors: true });\n        });\n    }\n    \n    public print(log: DataStreamDocument) {\n        const levels: Record<DataStreamDocument['level'], (...args: LogMethodArgs) => void> = {\n            info: (message: unknown, ...args: unknown[]) => console.info(this.styleMessage({ message: String(message), level: 'info', sender: log.sender }), ...args),\n            error: (message: unknown, ...args: unknown[]) => console.error(this.styleMessage({ message: String(message), level: 'error', sender: log.sender }), ...args),\n            warn: (message: unknown, ...args: unknown[]) => console.warn(this.styleMessage({ message: String(message), level: 'warn', sender: log.sender }), ...args),\n            success: (message: unknown, ...args: unknown[]) => console.log(this.styleMessage({ message: String(message), level: 'success', sender: log.sender }), ...args),\n            debug: (message: unknown, ...args: unknown[]) => console.debug(this.styleMessage({ message: String(message), level: 'debug', sender: log.sender }), ...args),\n        }\n        \n        if (log.level in levels) {\n            return levels[log.level](log.message);\n        }\n        \n        console.error('Unknown log level', log);\n    }\n    \n    public info(message: string, ...args: LogMethodArgs) {\n        this.send({ message, args, level: 'info' });\n    }\n    public error(message: string, ...args: LogMethodArgs) {\n        this.send({ message, args, level: 'error' });\n    }\n    public warn(message: string, ...args: LogMethodArgs) {\n        this.send({ message, args, level: 'warn' });\n    }\n    public success(message: string, ...args: LogMethodArgs) {\n        this.send({ message, args, level: 'success' });\n    }\n    public debug(message: string, ...args: LogMethodArgs) {\n        this.send({ message, args, level: 'debug' });\n    }\n}\n\ntype LogMethodArgs = unknown[];\n\nexport default new DDPLogger();","export class MeteorViteError extends Error {\nconstructor(message: string, details?: { cause?: unknown }) {\n        super(\n            `⚡  ${message}`,\n            // @ts-expect-error Might or might not be supported depending on Meteor's node version.\n            details\n        );\n    }\n}","import { cwd, getProjectPackageJson } from '../workers';\nimport Path from 'node:path';\nimport OS from 'node:os';\nimport FS from 'node:fs';\nimport { MeteorViteError } from './Errors';\n\nexport function msToHumanTime(milliseconds: number) {\n    const duration = {\n        count: milliseconds,\n        type: 'ms',\n    }\n    \n    if (milliseconds > 1000) {\n        duration.count = milliseconds / 1000;\n        duration.type = 's';\n    }\n    \n    if (duration.type === 's' && duration.count > 60) {\n        duration.type = 'min'\n        duration.count = duration.count / 60;\n    }\n    \n    return `${Math.round(duration.count * 100) / 100}${duration.type}`;\n}\n\nexport function posixPath(filePath: string) {\n    return filePath.split(Path.sep).join('/')\n}\n\nexport function getTempDir() {\n    const packageJson = getProjectPackageJson();\n    const tempRootDir = packageJson?.meteor?.vite?.tempBuildDir || OS.tmpdir();\n    \n    try {\n        const tempDir = Path.resolve(tempRootDir, 'meteor-vite', packageJson.name);\n        FS.mkdirSync(tempDir, { recursive: true });\n        return tempDir;\n    } catch (error) {\n        console.warn(new MeteorViteError(`Unable to set up temp directory for meteor-vite bundles. Will use node_modules instead`, { cause: error }));\n        return Path.resolve(cwd, 'node_modules', '.vite-meteor-temp');\n    }\n}\n\nexport function getDevServerHost(): { host: string, port: number, fallback: boolean } {\n    let { portString, hostname } = process.argv.join(' ').match(/--port[\\s=](?<hostname>[\\d\\w.]+:)?(?<portString>[\\d]+)/)?.groups || {};\n    const { METEOR_PORT, DDP_DEFAULT_CONNECTION_URL, MOBILE_DDP_URL } = process.env;\n    \n \n    if (!portString && METEOR_PORT) {\n        portString = METEOR_PORT;\n    }\n    \n    if (!portString && DDP_DEFAULT_CONNECTION_URL) {\n        const { port, host } = DDP_DEFAULT_CONNECTION_URL?.match(/\\/\\/(?<host>[\\d\\w\\-_.]+):(?<port>\\d+)/)?.groups || { port: '', host: '' };\n        portString = port;\n        hostname = host;\n    }\n    \n    if (!portString && MOBILE_DDP_URL) {\n        const { port } = MOBILE_DDP_URL?.match(/:(?<port>\\d+)/)?.groups || { port: '' };\n        portString = port;\n    }\n    \n    const port = parseInt(portString);\n    \n    if (Number.isNaN(port)) {\n        console.warn(new MeteorViteError(`Unable to determine the port for your Meteor development server. We're going to assume it's localhost:3000. If you're using a different port specify it using the METEOR_PORT environment variable so that Vite can function correctly. E.g. METEOR_PORT=3030`));\n        return {\n            fallback: true,\n            host: 'localhost',\n            port: 3000,\n        };\n    }\n    \n    return {\n        fallback: false,\n        host: hostname || 'localhost',\n        port,\n    };\n}\n\nexport function getMeteorRuntimeConfig() {\n    const appId = __meteor_bootstrap__?.configJson?.appId;\n    const { port, host, fallback } = getDevServerHost();\n    \n    if (!appId) {\n        console.warn(new MeteorViteError('Unable to retrieve your Meteor App ID. (`./.meteor/.id`) This is probably fine in most cases, but can lead to issues when running multiple concurrent instances. Please do report this issue on GitHub 🙏 https://github.com/JorgenVatle/meteor-vite/issues'));\n    }\n    \n    return {\n        host,\n        port,\n        appId,\n        fallback,\n    }\n}\n\nexport function getBuildConfig() {\n    const packageJson = getProjectPackageJson();\n    const tempDir = getTempDir();\n    \n    // Not in a project (publishing the package or in temporary Meteor build)\n    const pluginEnabled = !process.env.VITE_METEOR_DISABLED && !process.env.METEOR_VITE_DISABLED;\n    \n    /**\n     * Meteor client mainModule as specified in the package.json file. This is where we will push the final Vite bundle.\n     */\n    const meteorMainModule = packageJson.meteor?.mainModule?.client\n    \n    /**\n     * Destination directory inside the source Meteor project for the transpiled Vite bundle.\n     * This is what is fed into Meteor at the end of the build process.\n     */\n    const viteOutSrcDir = Path.join(cwd, '_vite-bundle', 'client')\n    \n    /**\n     * Check if Meteor is running using the --production flag and not actually bundling for production.\n     * This is important to check for as we normally clean up the files created for production once our compiler\n     * plugin finishes.\n     */\n    const isSimulatedProduction = process.argv.includes('--production');\n    \n    /**\n     * Intermediary Meteor project - used to build the Vite bundle in a safe environment where all the Meteor\n     * packages from the source project are available to our Vite plugin to analyze for creating ESM export stubs.\n     */\n    const tempMeteorProject = Path.resolve(tempDir, 'meteor') // Temporary Meteor project source\n    const tempMeteorOutDir = Path.join(tempDir, 'bundle', 'meteor'); // Temporary Meteor production bundle\n    \n    if (pluginEnabled && !packageJson.meteor.mainModule) {\n        throw new MeteorViteError('No meteor main module found, please add meteor.mainModule.client to your package.json')\n    }\n    \n    return {\n        packageJson,\n        tempMeteorOutDir,\n        tempMeteorProject,\n        isSimulatedProduction,\n        meteorMainModule,\n        pluginEnabled,\n        viteOutSrcDir,\n    }\n}\n\nexport type MeteorRuntimeConfig = ReturnType<typeof getMeteorRuntimeConfig>;","import pc from 'picocolors';\nimport { inspect } from 'node:util';\nimport fs from 'node:fs';\nimport { performance } from 'node:perf_hooks';\nimport { msToHumanTime } from './Helpers';\n\nclass BuildLogger {\n    protected debugEnabled = false;\n    protected github = new GithubActions();\n    protected static DEBUG_ENV_TRIGGERS = [\n        'true',\n        '*',\n        'vite-bundler:*',\n    ]\n    constructor() {\n        const debugEnv = process.env.DEBUG || 'false';\n        this.debugEnabled = !!debugEnv.trim().split(/\\s+/).find((field) => {\n            return BuildLogger.DEBUG_ENV_TRIGGERS.includes(field.trim())\n        });\n        \n    }\n    \n    public info(message: string, ...args: LogMethodArgs) {\n        console.info(pc.blue(`⚡  ${message}`), ...args)\n    }\n    public error(message: string, ...args: LogMethodArgs) {\n        this.github.annotate(message, {});\n        console.error(pc.red(`⚡  ${message}`), ...args)\n    }\n    public warn(message: string, ...args: LogMethodArgs) {\n        console.warn(pc.yellow(`⚡  ${message}`), ...args)\n    }\n    public success(message: string, ...args: LogMethodArgs) {\n        console.log(pc.green(`⚡  ${message}`), ...args)\n    }\n    public debug(message: string, ...args: LogMethodArgs) {\n        if (!this.debugEnabled) {\n            return;\n        }\n        console.debug(pc.dim(pc.blue(`⚡  ${message}`)), ...args)\n    }\n    \n    public startProfiler() {\n        const startTime = performance.now();\n        return {\n            complete: (message: string) => {\n                const messageWithTiming = `${message} in ${msToHumanTime(performance.now() - startTime)}`\n                this.success(messageWithTiming);\n                this.github.summarize(messageWithTiming);\n            }\n        }\n    }\n}\n\nclass GithubActions {\n    protected readonly summaryLines: string[] = [];\n    protected stepSummaryFile;\n    protected useAnnotations;\n    \n    constructor() {\n        if (process.env.METEOR_VITE_DISABLE_CI_SUMMARY === 'true') {\n            return;\n        }\n        this.stepSummaryFile = process.env.GITHUB_STEP_SUMMARY;\n        this.useAnnotations = !!this.stepSummaryFile;\n    }\n    \n    public annotate(message: string, options: GithubAnnotationOptions = {}) {\n        if (!this.useAnnotations) {\n            return;\n        }\n        const data: string[] = Object.entries(options).map(([key, value]) => {\n            return `${key}=\"${value}\"`\n        });\n        \n        console.log(`::notice ${data.join()}::⚡  ${message}`);\n    }\n    \n    public summarize(message: string, ...args: LogMethodArgs) {\n        if (!this.stepSummaryFile) {\n            return;\n        }\n        \n        const formattedArgs = args.length ? inspect(args) : '';\n        this.summaryLines.push(`⚡  ${message} ${formattedArgs}`);\n        const summary = [\n            '```log',\n            'Meteor-Vite build metrics:',\n            ...this.summaryLines,\n            '```',\n            '',\n            '<details>',\n            '<summary>Generated by Meteor Vite</summary>',\n            '\\n',\n            'Step summary generated by [`jorgenvatle:vite-bundler`](https://github.com/JorgenVatle/meteor-vite)',\n            'You can disable this behaviour with an environment variable: `METEOR_VITE_DISABLE_CI_SUMMARY=false`',\n            '',\n            '</details>',\n            '',\n        ]\n        fs.writeFileSync(this.stepSummaryFile, summary.join('\\n'));\n    }\n}\n\ninterface GithubAnnotationOptions {\n    title?: string;\n}\n\ntype LogMethodArgs = unknown[];\nexport default new BuildLogger();\n","export interface BoilerplateData {\n    css: string[];\n    js: {\n        url: string;\n        sri: string;\n    }[];\n    head: string;\n    body: string;\n    meteorManifest: string;\n    additionalStaticJs: string[];\n    meteorRuntimeConfig: string;\n    meteorRuntimeHash: string;\n    rootUrlPathPrefix: string;\n    bundledJsCssUrlRewriteHook: Function;\n    sriMode: undefined;\n    inlineScriptsAllowed: boolean;\n    inline: undefined;\n    htmlAttributes: Record<string, unknown>;\n    dynamicHead: string | undefined;\n    dynamicBody: string | undefined;\n}\n\nexport type Boilerplate = {\n    dynamicHead?: string;\n    dynamicBody?: string;\n}\n\nexport abstract class ViteBoilerplate {\n    public abstract getBoilerplate(): Promise<Boilerplate> | Boilerplate;\n}","import { fetch } from 'meteor/fetch';\nimport { Meteor } from 'meteor/meteor';\nimport { DDP_IPC } from '../api/DDP-IPC';\nimport {\n    DevConnectionLog,\n    getConfig,\n    MeteorViteConfig,\n    setConfig,\n    ViteConnection, ViteDevScripts,\n} from '../loading/vite-connection-handler';\nimport { getBuildConfig, getMeteorRuntimeConfig } from '../utility/Helpers';\nimport Logger from '../utility/Logger';\nimport { createWorkerFork, getProjectPackageJson, isMeteorIPCMessage, type WorkerInstance } from '../workers';\nimport { type Boilerplate, ViteBoilerplate } from './common';\n\n\nexport class ViteDevServerWorker extends ViteBoilerplate {\n    protected viteServer?: WorkerInstance;\n    constructor() {\n        super();\n    }\n    \n    public start() {\n        if (Meteor.isProduction) {\n            throw new Error('Tried to start Vite dev server in production!');\n        }\n        if (!getBuildConfig().pluginEnabled) {\n            Logger.warn('Meteor Vite plugin disabled. Aborting dev server startup');\n            return;\n        }\n        \n        DevConnectionLog.info('Starting Vite server...');\n        const ipc = new DDP_IPC({\n            async viteConfig(config) {\n                const { ready } = await setConfig(config);\n                if (ready) {\n                    DevConnectionLog.info(`Meteor-Vite ready for connections!`)\n                }\n            },\n            \n            refreshNeeded() {\n                DevConnectionLog.info('Some lazy-loaded packages were imported, please refresh')\n            },\n        })\n        const viteServer = this.viteServer = createWorkerFork({\n            viteConfig: ipc.responseHooks.viteConfig,\n            refreshNeeded: ipc.responseHooks.refreshNeeded,\n        }, { detached: true, ipc });\n        \n        Meteor.publish(ViteConnection.publication, () => {\n            return MeteorViteConfig.find(ViteConnection.configSelector);\n        });\n        \n        Meteor.methods({\n            [ViteConnection.methods.refreshConfig]() {\n                DevConnectionLog.info('Refreshing configuration from Vite dev server...')\n                viteServer.call({\n                    method: 'vite.server.getConfig',\n                    params: [],\n                });\n                return getConfig();\n            }\n        });\n        \n        viteServer.call({\n            method: 'vite.server.start',\n            params: [{\n                packageJson: getProjectPackageJson(),\n                meteorParentPid: process.ppid,\n                meteorConfig: getMeteorRuntimeConfig(),\n            }]\n        });\n        \n        // Forward IPC messages from the `meteor-tool` parent process to the Vite server\n        // Used to notify our Vite build plugin of things like the client bundle or Atmosphere packages being rebuilt.\n        process.on('message', async (message) => {\n            if (!isMeteorIPCMessage(message)) return;\n            const { baseUrl, ready } = await getConfig();\n            if (!ready) return;\n            \n            await fetch(`${baseUrl}/__meteor__/ipc-message`, {\n                method: 'POST',\n                body: JSON.stringify(message),\n            }).catch((error: unknown) => {\n                console.error(error);\n            })\n        })\n    }\n    \n    public async getBoilerplate(): Promise<Boilerplate> {\n        const scripts = new ViteDevScripts(await getConfig());\n        \n        return {\n            dynamicBody: await scripts.stringTemplate(),\n        }\n    }\n}","import FS from 'fs';\nimport type { TransformedViteManifest } from 'meteor-vite/meteor/IPC/methods/build';\nimport { Meteor } from 'meteor/meteor';\nimport { WebApp, WebAppInternals } from 'meteor/webapp';\nimport Path from 'path';\nimport Util from 'util';\nimport Logger from '../utility/Logger';\nimport { type Boilerplate, ViteBoilerplate } from './common';\n\nexport class ViteProductionBoilerplate extends ViteBoilerplate {\n    \n    constructor() {\n        super();\n    }\n    \n    public get assetDir() {\n        return '/' + this.viteManifest.assetsDir.replace(/^\\/+/, '');\n    }\n    \n    public get baseUrl() {\n        return this.viteManifest.base;\n    }\n    \n    protected filePath(file: string) {\n        return `${this.baseUrl.replace(/\\/?$/, '')}/${file}`;\n    }\n    \n    public getBoilerplate(): Boilerplate {\n        return {\n            dynamicHead: this.dynamicHead,\n            dynamicBody: ''\n        };\n    }\n    \n    protected get dynamicHead() {\n        const imports = this.imports;\n        const lines = [];\n        const prefetchArray: PrefetchObject[] = [];\n        \n        for (const file of imports.stylesheets) {\n            lines.push(`<link rel=\"stylesheet\" crossorigin href=\"${this.filePath(file)}\">`);\n        }\n        \n        for (const file of imports.modules) {\n            lines.push(`<script type=\"module\" crossorigin src=\"${this.filePath(file)}\"></script>`);\n        }\n        \n        for (const file of imports.modulePreload) {\n            lines.push(`<link rel=\"modulepreload\" crossorigin href=\"${this.filePath(file)}\">`);\n        }\n        \n        for (const file of imports.moduleLazyPrefetch) {\n            prefetchArray.push({\n                href: this.filePath(file),\n            })\n        }\n        \n        for (const file of imports.cssLazyPrefetch) {\n            prefetchArray.push({\n                href: this.filePath(file),\n                as: 'style',\n            })\n        }\n        \n        function lazyPrefetch(assets: PrefetchObject[]) {\n            window.addEventListener('load', () => window.setTimeout(() => {\n                const makeLink = (asset: PrefetchObject) => {\n                    const link = document.createElement('link')\n                    link.rel = 'prefetch';\n                    link.fetchPriority = 'low';\n                    \n                    Object.entries(asset).forEach(([key, value]) => {\n                        link.setAttribute(key, value)\n                    })\n                    \n                    return link\n                }\n                \n                const loadNext = (assets: PrefetchObject[], count: number) => window.setTimeout(() => {\n                    if (count > assets.length) {\n                        count = assets.length\n                        \n                        if (count === 0) {\n                            return\n                        }\n                    }\n                    \n                    const fragment = new DocumentFragment\n                    \n                    while (count > 0) {\n                        const asset = assets.shift();\n                        if (!asset) {\n                            break;\n                        }\n                        const link = makeLink(asset)\n                        fragment.append(link)\n                        count--\n                        \n                        if (assets.length) {\n                            link.onload = () => loadNext(assets, 1)\n                            link.onerror = () => loadNext(assets, 1)\n                        }\n                    }\n                    \n                    document.head.append(fragment)\n                })\n                \n                loadNext(assets, 3);\n            }))\n        }\n        \n        if (!process.env.DISABLE_FULL_APP_PREFETCH) {\n            lines.push(\n                `<script type=\"text/javascript\">`,\n                `${lazyPrefetch.toString()};`,\n                `lazyPrefetch(${JSON.stringify(prefetchArray)})`,\n                `</script>`\n            )\n        }\n        \n        return lines.join('\\n');\n    }\n    \n    public get viteManifest(): TransformedViteManifest {\n        if (Meteor.settings.vite?.manifest) {\n            return Meteor.settings.vite.manifest;\n        }\n        \n        // Search Meteor's program.json file for Vite's manifest.json file\n        const viteManifestInfo = WebApp.clientPrograms['web.browser'].manifest.find(({ path }: MeteorProgramManifest) => path.endsWith('vite-manifest.json'));\n        if (!viteManifestInfo) {\n            throw new Error('Could not find Vite manifest in Meteor client program manifest');\n        }\n        \n        // Read and cache the contents of the vite manifest.json file.\n        const viteManifestPath = Path.join(__meteor_bootstrap__.serverDir, '..', 'web.browser', viteManifestInfo.path);\n        const manifest = JSON.parse(FS.readFileSync(viteManifestPath, 'utf8'));\n        Meteor.settings.vite = { manifest };\n        \n        return manifest;\n    }\n    \n    /**\n     * Mark assets built by Vite as cacheable in Meteor's program.json file for both legacy and modern browsers.\n     * Because of the way Meteor handles non-cacheable assets, headers are added that make it tricky to cache with\n     * a standard reverse proxy config. You would have to explicitly override the caching headers for all files served\n     * by meteor at /vite-assets.\n     *\n     * The default behavior of Meteor would be to set a max-age header of 0. Which would of course result in a lot of\n     * load being put on both your clients and your server.\n     */\n    public makeViteAssetsCacheable() {\n        const archs = ['web.browser', 'web.browser.legacy'] as const;\n        \n        for (const arch of archs) {\n            const files = WebAppInternals.staticFilesByArch[arch] || {};\n            \n            // Override cacheable flag for any assets built by Vite.\n            // Meteor will by default set this to false for asset files.\n            Object.entries(files).forEach(([path, file]) => {\n                if (!path.startsWith(`${this.assetDir}/`)) {\n                    return;\n                }\n                if (path.endsWith('.js')) {\n                    file.cacheable = true;\n                }\n                if (path.endsWith('.css')) {\n                    file.cacheable = true;\n                }\n            })\n        }\n    }\n    \n    \n    protected get imports(): ManifestImports {\n        if (Meteor.settings.vite?.imports) {\n            return Meteor.settings.vite.imports;\n        }\n        \n        const manifest = this.viteManifest;\n        const stylesheets = new Set<string>()\n        const modules = new Set<string>()\n        const modulePreload = new Set<string>();\n        const moduleLazyPrefetch = new Set<string>();\n        const cssLazyPrefetch = new Set<string>();\n        \n        function preloadImports(imports: string[]) {\n            for (const path of imports) {\n                const chunk = manifest.files[path];\n                if (!chunk) {\n                    continue;\n                }\n                if (modulePreload.has(chunk.file)) {\n                    continue;\n                }\n                moduleLazyPrefetch.delete(chunk.file);\n                modulePreload.add(chunk.file);\n                chunk.css?.forEach(css => stylesheets.add(css));\n                preloadImports(chunk.imports || []);\n            }\n            \n        }\n        \n        // Todo: Preload all assets app assets in the background after loading essential assets.\n        //  rel=\"preload\" fetchPriority=\"low\"\n        for (const [name, chunk] of Object.entries(manifest.files)) {\n            if (!chunk.isEntry) {\n                if (chunk.file.endsWith('.js')) {\n                    moduleLazyPrefetch.add(chunk.file);\n                }\n                if (chunk.file.endsWith('.css')) {\n                    cssLazyPrefetch.add(chunk.file);\n                }\n                continue;\n            }\n            \n            if (chunk.file.endsWith('.js')) {\n                moduleLazyPrefetch.delete(chunk.file);\n                modules.add(chunk.file);\n            }\n            \n            if (chunk.file.endsWith('.css')) {\n                stylesheets.add(chunk.file);\n            }\n            \n            preloadImports(chunk.imports || []);\n            \n            chunk.css?.forEach(css => {\n                stylesheets.add(css);\n                cssLazyPrefetch.delete(css);\n            });\n        }\n        \n        const imports = {\n            stylesheets,\n            modules,\n            modulePreload,\n            moduleLazyPrefetch,\n            cssLazyPrefetch,\n        }\n        \n        Logger.debug('Parsed Vite manifest imports', Util.inspect({\n            imports,\n            manifest,\n            modules,\n        }, { depth: 4, colors: true }));\n        \n        Object.assign(Meteor.settings.vite, { imports });\n        \n        return imports;\n    }\n}\n\ninterface MeteorProgramManifest {\n    path: string;\n    url?: string;\n    cacheable: boolean;\n}\n\ninterface PrefetchObject {\n    href: string;\n    as?: 'style';\n}\n\ninterface ManifestImports {\n    stylesheets: Set<string>;\n    modules: Set<string>;\n    modulePreload: Set<string>;\n    moduleLazyPrefetch: Set<string>;\n    cssLazyPrefetch: Set<string>;\n}"]}